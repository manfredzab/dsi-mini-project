<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DSI Mini Project: /home/manfred/git/dsi-mini-project/include/binary_sort_merge_join_iterator.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DSI Mini Project
   </div>
   <div id="projectbrief">Database Systems Implementation Examination Project, Hilary Term 2013, University of Oxford. Candidate number: 875114.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('binary__sort__merge__join__iterator_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">binary_sort_merge_join_iterator.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef BINARY_SORT_MERGE_JOIN_ITERATOR_H_</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define BINARY_SORT_MERGE_JOIN_ITERATOR_H_</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;equality.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;relation.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;interface_iterator.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;simple_iterator.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">namespace </span>c875114</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html">   19</a></span>&#160;<span class="keyword">class </span><a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html" title="Binary sort-merge join iterator.">BinarySortMergeJoinIterator</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classc875114_1_1_i_iterator.html" title="Generic iterator interface.">IIterator</a>&lt;int*&gt;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="code" href="structc875114_1_1_binary_sort_merge_join_iterator_1_1_attribute_order_descriptor.html">   26</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="structc875114_1_1_binary_sort_merge_join_iterator_1_1_attribute_order_descriptor.html" title="Holder of information on how to produce the correct order of attributes in the resulting relation&#39;s t...">AttributeOrderDescriptor</a></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        {</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="code" href="structc875114_1_1_binary_sort_merge_join_iterator_1_1_attribute_order_descriptor.html#add0347f2c1d1f1adb48edc3f0e55dd26">   28</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="structc875114_1_1_binary_sort_merge_join_iterator_1_1_attribute_order_descriptor.html#add0347f2c1d1f1adb48edc3f0e55dd26" title="Flag to check whether the result tuple value should be produced by taking a value from the outer or f...">is_outer_relation</a>;        </div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="code" href="structc875114_1_1_binary_sort_merge_join_iterator_1_1_attribute_order_descriptor.html#a993e713c1f3077c382a061642696949a">   30</a></span>&#160;            <span class="keywordtype">int</span>  <a class="code" href="structc875114_1_1_binary_sort_merge_join_iterator_1_1_attribute_order_descriptor.html#a993e713c1f3077c382a061642696949a" title="Index of the attribute from which the value should be taken.">relation_attribute_index</a>; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        };</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html#a9af65f09b155953c843fbe1a8b6593a9" title="Constructs a binary sort-merge join iterator from the given outer and inner relations, information on how to build the resulting relation tuple from two input relation tuples and the join attribute positions in each relation.">BinarySortMergeJoinIterator</a>(<a class="code" href="structc875114_1_1_relation.html" title="Relation detail holder: stores relation name, attribute names and tuple data.">Relation</a>&amp; outer_relation,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                    <a class="code" href="structc875114_1_1_relation.html" title="Relation detail holder: stores relation name, attribute names and tuple data.">Relation</a>&amp; inner_relation,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                    <span class="keyword">const</span> std::vector&lt;AttributeOrderDescriptor&gt;&amp; result_relation_tuple_order,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                    <span class="keyword">const</span> std::vector&lt;int&gt;&amp; outer_relation_join_attribute_positions,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                    <span class="keyword">const</span> std::vector&lt;int&gt;&amp; inner_relation_join_attribute_positions);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keyword">virtual</span> <a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html#a005208e4c3a53c8f09e9ca000124529a" title="Releases all resources occupied by the binary sort-merge join iterator.">~BinarySortMergeJoinIterator</a>();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keyword">virtual</span> Status <a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html#a500ed101e98f63e2ea7cea054756641c" title="Initializes the iterator.">Init</a>();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keyword">virtual</span> Status <a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html#a391ade4c6382d64ee0ace95fd3ffb921" title="Returns the tuple key at a current position of the iterator.">Key</a>(<span class="keywordtype">int</span>** out_key);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keyword">virtual</span> Status <a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html#a96736f45734bbe76829e5d9beebec990" title="Not supported by the binary sort merge join iterator.">Multiplicity</a>(<span class="keywordtype">int</span>* out_result);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keyword">virtual</span> Status <a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html#abc6d6bc75f97bf3d2e6d733007961471" title="Positions the join iterator at the next position in the join result.">Next</a>();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span>   <a class="code" href="classc875114_1_1_binary_sort_merge_join_iterator.html#a4c2fa544ed7ce59784f417fc822b314d" title="Checks if the join iterator is positioned at the last tuple in the join result.">AtEnd</a>();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keyword">struct </span>SameRelationTupleComparisonFunctor</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            SameRelationTupleComparisonFunctor(<span class="keyword">const</span> std::vector&lt;int&gt;&amp; compare_positions) : compare_positions(compare_positions)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                compare_positions_count = compare_positions.size();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            };</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            Equality CompareTuples(<span class="keyword">const</span> <span class="keywordtype">int</span>* first_tuple, <span class="keyword">const</span> <span class="keywordtype">int</span>* second_tuple)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; compare_positions_count; i++)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    <span class="keywordflow">if</span> (first_tuple[compare_positions[i]] &gt; second_tuple[compare_positions[i]])</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                        <span class="keywordflow">return</span> kGreaterThan;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (first_tuple[compare_positions[i]] &lt; second_tuple[compare_positions[i]])</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                        <span class="keywordflow">return</span> kLessThan;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                <span class="keywordflow">return</span> kEqual;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> <span class="keywordtype">int</span>* first_tuple, <span class="keyword">const</span> <span class="keywordtype">int</span>* second_tuple)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <span class="keywordflow">return</span> (kLessThan == CompareTuples(first_tuple, second_tuple));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keyword">const</span> std::vector&lt;int&gt;&amp; compare_positions;        </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordtype">int</span>                     compare_positions_count;  </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        };</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">void</span>     GatherSameKeyTuples(SimpleIterator&amp; relation_iterator, SameRelationTupleComparisonFunctor&amp; comparison_functor, std::list&lt;int*&gt;&amp; out_same_key_tuples);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">void</span>     CreateResultTupleAsKey(<span class="keywordtype">int</span>* outer_tuple, <span class="keywordtype">int</span>* inner_tuple);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        Equality CompareTuplesAtDifferentRelations(<span class="keywordtype">int</span>* outer_relation_tuple, <span class="keywordtype">int</span>* inner_relation_tuple);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        Relation&amp;                                    outer_relation;                          </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        Relation&amp;                                    inner_relation;                          </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        SimpleIterator*                              outer_relation_iterator;                 </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        SimpleIterator*                              inner_relation_iterator;                 </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        SameRelationTupleComparisonFunctor           outer_relation_tuple_comparison_functor; <span class="comment">/* Outer relation tuple comparison functor. */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        SameRelationTupleComparisonFunctor           inner_relation_tuple_comparison_functor; <span class="comment">/* Inner relation tuple comparison functor. */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        std::list&lt;int*&gt;                              outer_relation_duplicates;               </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        std::list&lt;int*&gt;                              inner_relation_duplicates;               </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        std::list&lt;int*&gt;::iterator                    inner_relation_duplicates_position;      </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordtype">int</span>*                                         key;                                     </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordtype">bool</span>                                         at_end;                                  </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">const</span> std::vector&lt;AttributeOrderDescriptor&gt;&amp; result_relation_tuple_order;             </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordtype">int</span>                                          result_relation_attribute_count;         </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keyword">const</span> std::vector&lt;int&gt;&amp;                      outer_relation_join_attribute_positions; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keyword">const</span> std::vector&lt;int&gt;&amp;                      inner_relation_join_attribute_positions; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordtype">int</span>                                          join_attribute_count;                    </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;};</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;} <span class="comment">/* namespace c875114 */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* BINARY_SORT_MERGE_JOIN_ITERATOR_H_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_9bec7083027963d9f9ceae2cc7474de5.html">git</a></li><li class="navelem"><a class="el" href="dir_5f7917324dd3531ad5091474fec5d929.html">dsi-mini-project</a></li><li class="navelem"><a class="el" href="dir_cd053fb20616144d9b3fb80d67110617.html">include</a></li><li class="navelem"><b>binary_sort_merge_join_iterator.h</b></li>
    <li class="footer">Generated on Sun Mar 24 2013 00:07:54 for DSI Mini Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
